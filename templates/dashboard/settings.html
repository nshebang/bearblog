{% extends 'base.html' %}

{% block title %}Ajustes del blog@Ichoria★Blogs{% endblock %}

{% block custom_styles %}
    {% include 'styles/blog/default.css' %}
    {% include 'styles/dashboard.css' %}
    {{ request.user.settings.dashboard_styles | safe }}
{% endblock %}

{% block nav %}{% include '../snippets/dashboard_nav.html' %}{% endblock %}

{% block content %}
<h1>Ajustes del blog</h1>
<p>
    <form method="POST" class="post-form full-width">
        {% csrf_token %}
        {% if error_messages %}
        <p style="color:lightsalmon">
            {% for error_message in error_messages %}
                {{ error_message }}<br>
            {% endfor %}
        </p>
        {% endif %}
        <label for="slug">Subdominio</label>
        <br>
        <div style="display: flex;align-items:end">
            <input
                type="text" name="subdomain"
                value="{{ blog.subdomain }}"
                required autocorrect="off"
                autocomplete="off"
                spellcheck="false"
                style="max-width:200px; margin-right: 10px;"
            />
            <span class="helptext">.ichoria.cc</span>
        </div>
        <button type="submit">Guardar cambios</button>
    </form>
</p>
<p>
    <a href="{% url 'directive_edit' id=blog.subdomain %}">Directivas de cabecera y pie de página</a>
</p>
<p>
    <a href="{% url 'advanced_settings' id=blog.subdomain %}">Opciones avanzadas</a>
</p>
{% comment %} 
<p>
    {% if blog.auth_token %}
    <label for="auth_token">Auth token:</label>
    <br>
    <input type="text" readonly style="width:350px" value="{{ blog.auth_token }}">
    <br>
    <button onclick="window.location = '?generate=True'" style="font-size:20px;">⟳</button>
    {% else %}
    <button onclick="window.location = '?generate=True'">Generate auth token</button>
    {% endif %}
</p>
{% endcomment %}

<p>
    <a href="?export=true" download>Exportar datos del blog</a>
</p>
<p>
    <a onclick="if (confirm('¿Confirmas que quieres eliminar {{ blog.subdomain }}? Todo el contenido será borrado permanentemente.')) { window.location.href='{% url 'blog_delete' blog.subdomain %}'; }">
        Eliminar blog
    </a>

</p>
{% endblock %}
